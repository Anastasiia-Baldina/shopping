<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Пополнить кошелек</title>
    <link rel="stylesheet" type="text/css" href="css/common.css">
</head>
<body>
<a href="index.html">Home</a>
<br>
<h3>Rest запрос на пополнение кошелька</h3>
<form id="deposit">
    <input type="text" id="userId" placeholder="Имя заказчика">
    <input type="number" id="amount" placeholder="Сумма пополнения">
    <button type="submit">Пополнить кошелек</button>
</form>

<h3>Результат REST</h3>
<div id="restResult"></div>

<script>
    function clearResults() {
        document.getElementById('restResult').textContent = "";
    }

    function showRestResult(result) {
        console.log("Успех:", result)
        view = document.getElementById('restResult');
        view.textContent = "Успешно:" + JSON.stringify(result);
    }

    function showRestError(result) {
        console.log("Error:", result)
        view = document.getElementById('restResult');
        view.textContent = "Ошибка:" + JSON.stringify(result);
    }

    document.getElementById('deposit').addEventListener('submit', function(e) {
       e.preventDefault();
       clearResults();

        const data = {
            userId: {
                value: document.getElementById('userId').value
            },
            amount: document.getElementById('amount').value
        };

        console.log("post:" + JSON.stringify(data));

        fetch('http://localhost:8081/pay/deposit', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => showRestResult(data))
        .catch(error => showRestError(error));
    });
</script>
</body>
</html>